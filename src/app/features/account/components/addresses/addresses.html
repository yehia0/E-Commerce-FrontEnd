<h2 class="section-title">Saved Addresses</h2>

<div class="address-list">
  <div *ngFor="let address of addresses()" class="address-card">
    <div class="address-actions">
      <button class="icon-action" (click)="editAddress(address)">âœï¸</button>
      <button class="icon-action" (click)="deleteAddress(address._id!)">ğŸ—‘ï¸</button>
    </div>
    <div class="address-type">
      {{ getAddressType(address.type) }}
      <span *ngIf="address.isDefault" class="address-default">Default</span>
    </div>
    <div>{{ address.addressLine }}</div>
    <div>{{ address.city }}, {{ address.state }}</div>
    <button
      *ngIf="!address.isDefault"
      class="set-default-btn"
      (click)="setDefaultAddress(address._id!)">
      Set as Default
    </button>
  </div>
</div>

<button class="btn btn-primary add-btn" (click)="toggleAddForm()">
  {{ showAddForm ? 'Cancel' : '+ Add New Address' }}
</button>

<div *ngIf="showAddForm" class="address-form">
  <h3>{{ editingAddress ? 'Edit Address' : 'New Address' }}</h3>

  <form (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label>Address *</label>
      <input type="text" [(ngModel)]="newAddress.addressLine" name="addressLine" required>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>City *</label>
        <input type="text" [(ngModel)]="newAddress.city" name="city" required>
      </div>
      <div class="form-group">
        <label>State / Province *</label>
        <input type="text" [(ngModel)]="newAddress.state" name="state" required>
      </div>
    </div>

    <div class="form-group">
      <label>Address Type</label>
      <select [(ngModel)]="newAddress.type" name="type">
        <option value="home">Home</option>
        <option value="office">Office</option>
        <option value="other">Other</option>
      </select>
    </div>

    <div class="form-group">
      <label class="checkbox-label">
        <input type="checkbox" [(ngModel)]="newAddress.isDefault" name="isDefault">
        Set as default address
      </label>
    </div>

    <button type="submit" class="btn btn-primary" [disabled]="!isFormValid()">
      {{ editingAddress ? 'Update Address' : 'Save Address' }}
    </button>
  </form>
</div>
<!-- Delete Confirmation Modal -->
<app-confirmation-modal
  [config]="deleteConfirmationConfig"
  [isVisible]="showDeleteConfirmation"
  (confirmed)="onConfirmDelete()"
  (cancelled)="onCancelDelete()">
</app-confirmation-modal>
